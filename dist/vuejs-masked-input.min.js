/*!
  * vuejs-masked-input v0.5.5
  * (c) 2018 Andrej Adamcik
  * @license MIT
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.VueMaskedInput=e()}(this,function(){"use strict";function a(t,e){if(e)for(var s=Object.keys(e),i=0,n=s.length;i<n;i++)t[s[i]]=e[s[i]];return t}function o(t){return a({},t)}var e=/^\d$/,s=/^[A-Za-z]$/,i=/^[\dA-Za-z]$/,n="_",l={"*":{validate:function(t){return i.test(t)}},1:{validate:function(t){return e.test(t)}},a:{validate:function(t){return s.test(t)}},A:{validate:function(t){return s.test(t)},transform:function(t){return t.toUpperCase()}},"#":{validate:function(t){return i.test(t)},transform:function(t){return t.toUpperCase()}}};function r(t,e,s,i){if(!(this instanceof r))return new r(t,e,s);this.placeholderChar=s||n,this.formatCharacters=e||l,this.source=t,this.pattern=[],this.length=0,this.firstEditableIndex=null,this.lastEditableIndex=null,this._editableIndices={},this.isRevealingMask=i||!1,this._parse()}function h(t){if(!(this instanceof h))return new h(t);if(null==(t=a({formatCharacters:null,pattern:null,isRevealingMask:!1,placeholderChar:n,selection:{start:0,end:0},value:""},t)).pattern)throw new Error("InputMask: you must provide a pattern.");if("string"!=typeof t.placeholderChar||1<t.placeholderChar.length)throw new Error("InputMask: placeholderChar should be a single character or an empty string.");this.placeholderChar=t.placeholderChar,this.formatCharacters=function(t){var e=o(l);if(t)for(var s=Object.keys(t),i=0,n=s.length;i<n;i++){var r=s[i];null==t[r]?delete e[r]:e[r]=t[r]}return e}(t.formatCharacters),this.setPattern(t.pattern,{value:t.value,selection:t.selection,isRevealingMask:t.isRevealingMask})}r.prototype._parse=function(){for(var t=this,e=this.source.split(""),s=0,i=[],n=0,r=e.length;n<r;n++){var a=e[n];if("\\"===a){if(n===r-1)throw new Error("InputMask: pattern ends with a raw \\");a=e[++n]}else a in t.formatCharacters&&(null===t.firstEditableIndex&&(t.firstEditableIndex=s),t.lastEditableIndex=s,t._editableIndices[s]=!0);i.push(a),s++}if(null===this.firstEditableIndex)throw new Error('InputMask: pattern "'+this.source+'" does not contain any editable characters.');this.pattern=i,this.length=i.length},r.prototype.formatValue=function(t){for(var e=this,s=new Array(this.length),i=0,n=0,r=this.length;n<r;n++)if(e.isEditableIndex(n)){if(e.isRevealingMask&&t.length<=i&&!e.isValidAtIndex(t[i],n))break;s[n]=t.length>i&&e.isValidAtIndex(t[i],n)?e.transform(t[i],n):e.placeholderChar,i++}else s[n]=e.pattern[n],t.length>i&&t[i]===e.pattern[n]&&i++;return s},r.prototype.isEditableIndex=function(t){return!!this._editableIndices[t]},r.prototype.isValidAtIndex=function(t,e){return this.formatCharacters[this.pattern[e]].validate(t)},r.prototype.transform=function(t,e){var s=this.formatCharacters[this.pattern[e]];return"function"==typeof s.transform?s.transform(t):t},h.prototype.input=function(t){var e=this;if(this.selection.start===this.selection.end&&this.selection.start===this.pattern.length)return!1;var s=o(this.selection),i=this.getValue(),n=this.selection.start;if(n<this.pattern.firstEditableIndex&&(n=this.pattern.firstEditableIndex),this.pattern.isEditableIndex(n)){if(!this.pattern.isValidAtIndex(t,n))return!1;this.value[n]=this.pattern.transform(t,n)}for(var r=this.selection.end-1;n<r;)e.pattern.isEditableIndex(r)&&(e.value[r]=e.placeholderChar),r--;for(this.selection.start=this.selection.end=n+1;this.pattern.length>this.selection.start&&!this.pattern.isEditableIndex(this.selection.start);)e.selection.start++,e.selection.end++;return null!=this._historyIndex&&(this._history.splice(this._historyIndex,this._history.length-this._historyIndex),this._historyIndex=null),("input"!==this._lastOp||s.start!==s.end||null!==this._lastSelection&&s.start!==this._lastSelection.start)&&this._history.push({value:i,selection:s,lastOp:this._lastOp}),this._lastOp="input",this._lastSelection=o(this.selection),!0},h.prototype.backspace=function(){if(0===this.selection.start&&0===this.selection.end)return!1;var t=o(this.selection),e=this.getValue();if(this.selection.start===this.selection.end)this.pattern.isEditableIndex(this.selection.start-1)&&(this.value[this.selection.start-1]=this.placeholderChar),this.selection.start--,this.selection.end--;else{for(var s=this.selection.end-1;s>=this.selection.start;)this.pattern.isEditableIndex(s)&&(this.value[s]=this.placeholderChar),s--;this.selection.end=this.selection.start}return null!=this._historyIndex&&this._history.splice(this._historyIndex,this._history.length-this._historyIndex),("backspace"!==this._lastOp||t.start!==t.end||null!==this._lastSelection&&t.start!==this._lastSelection.start)&&this._history.push({value:e,selection:t,lastOp:this._lastOp}),this._lastOp="backspace",this._lastSelection=o(this.selection),!0},h.prototype.paste=function(t){var e=this,s={value:this.value.slice(),selection:o(this.selection),_lastOp:this._lastOp,_history:this._history.slice(),_historyIndex:this._historyIndex,_lastSelection:o(this._lastSelection)};if(this.selection.start<this.pattern.firstEditableIndex){for(var i=0,n=this.pattern.firstEditableIndex-this.selection.start;i<n;i++)if(t.charAt(i)!==e.pattern.pattern[i])return!1;t=t.substring(this.pattern.firstEditableIndex-this.selection.start),this.selection.start=this.pattern.firstEditableIndex}for(i=0,n=t.length;i<n&&this.selection.start<=this.pattern.lastEditableIndex;i++){if(!e.input(t.charAt(i))){if(0<e.selection.start){var r=e.selection.start-1;if(!e.pattern.isEditableIndex(r)&&t.charAt(i)===e.pattern.pattern[r])continue}return a(e,s),!1}}return!0},h.prototype.undo=function(){if(0===this._history.length||0===this._historyIndex)return!1;var t;if(null==this._historyIndex){this._historyIndex=this._history.length-1,t=this._history[this._historyIndex];var e=this.getValue();t.value===e&&t.selection.start===this.selection.start&&t.selection.end===this.selection.end||this._history.push({value:e,selection:o(this.selection),lastOp:this._lastOp,startUndo:!0})}else t=this._history[--this._historyIndex];return this.value=t.value.split(""),this.selection=t.selection,this._lastOp=t.lastOp,!0},h.prototype.redo=function(){if(0===this._history.length||null==this._historyIndex)return!1;var t=this._history[++this._historyIndex];return this._historyIndex===this._history.length-1&&(this._historyIndex=null,t.startUndo&&this._history.pop()),this.value=t.value.split(""),this.selection=t.selection,this._lastOp=t.lastOp,!0},h.prototype.setPattern=function(t,e){e=a({selection:{start:0,end:0},value:""},e),this.pattern=new r(t,this.formatCharacters,this.placeholderChar,e.isRevealingMask),this.setValue(e.value),this.emptyValue=this.pattern.formatValue([]).join(""),this.selection=e.selection,this._resetHistory()},h.prototype.setSelection=function(t){var e=this;if(this.selection=o(t),this.selection.start===this.selection.end){if(this.selection.start<this.pattern.firstEditableIndex)return this.selection.start=this.selection.end=this.pattern.firstEditableIndex,!0;for(var s=this.selection.start;s>=this.pattern.firstEditableIndex;){if(e.pattern.isEditableIndex(s-1)&&e.value[s-1]!==e.placeholderChar||s===e.pattern.firstEditableIndex){e.selection.start=e.selection.end=s;break}s--}return!0}return!1},h.prototype.setValue=function(t){null==t&&(t=""),this.value=this.pattern.formatValue(t.split(""))},h.prototype.getValue=function(){return this.value.join("")},h.prototype.getRawValue=function(){for(var t=[],e=0;e<this.value.length;e++)!0===this.pattern._editableIndices[e]&&t.push(this.value[e]);return t.join("")},h.prototype._resetHistory=function(){this._history=[],this._historyIndex=null,this._lastOp=null,this._lastSelection=o(this.selection)},h.Pattern=r;var t=h;return function(){function e(t){var e="focus"===t.type?"focusin":"focusout",s=new CustomEvent(e,{bubbles:!0,cancelable:!1});s.c1Generated=!0,t.target.dispatchEvent(s)}function s(t){t.c1Generated||(window.document.removeEventListener("focus",e,!0),window.document.removeEventListener("blur",e,!0),window.document.removeEventListener("focusin",s,!0),window.document.removeEventListener("focusout",s,!0)),setTimeout(function(){window.document.removeEventListener("focusin",s,!0),window.document.removeEventListener("focusout",s,!0)})}"undefined"!=typeof window&&void 0===window.onfocusin&&(window.document.addEventListener("focus",e,!0),window.document.addEventListener("blur",e,!0),window.document.addEventListener("focusin",s,!0),window.document.addEventListener("focusout",s,!0))}(),{name:"MaskedInput",render:function(t){return t("input",{ref:"input",attrs:{disabled:null===this.maskCore||this.disabled},domProps:{value:this.value},on:{keydown:this.keyDown,keypress:this.keyPress,keyup:this.keyUp,textInput:this.textInput,mouseup:this.mouseUp,focusout:this.focusOut,cut:this.cut,copy:this.copy,paste:this.paste}})},data:function(){return{marginLeft:0,maskCore:null,updateAfterAll:!1}},props:{value:{type:String},mask:{required:!0,validator:function(t){return!!(t&&1<=t.length||t instanceof Object)}},placeholderChar:{type:String,default:"_",validator:function(t){return!(!t||1!==t.length)}},disabled:{type:Boolean,default:!1}},watch:{mask:function(t,e){JSON.stringify(t)!==JSON.stringify(e)&&this.initMask()},value:function(t){this.maskCore&&this.maskCore.setValue(t)}},mounted:function(){this.initMask()},methods:{initMask:function(){var s=this;try{this.mask instanceof Object?this.maskCore=new t(this.mask):this.maskCore=new t({pattern:this.mask,value:"",placeholderChar:this.placeholderChar,formatCharacters:{a:{validate:function(t){return/^[A-Za-z\u0410-\u042f\u0430-\u044f]$/.test(t)}},A:{validate:function(t){return/^[A-Za-z\u0410-\u042f\u0430-\u044f]$/.test(t)},transform:function(t){return t.toUpperCase()}},"*":{validate:function(t){return/^[\dA-Za-z\u0410-\u042f\u0430-\u044f]$/.test(t)}},"#":{validate:function(t){return/^[\dA-Za-z\u0410-\u042f\u0430-\u044f]$/.test(t)},transform:function(t){return t.toUpperCase()}},"+":{validate:function(){return!0}}}}),[].concat(this.$refs.input.value).reduce(function(t,e){return s.maskCore.input(e)},null),this.maskCore.setSelection({start:0,end:0}),""===this.$refs.input.value?this.$emit("input","",""):this.updateToCoreState()}catch(t){this.maskCore=null,this.$refs.input.value="Error",this.$emit("input",this.$refs.input.value,"")}},getValue:function(){return this.maskCore?this.maskCore.getValue():""},keyDown:function(t){if(null!==this.maskCore)switch(this.setNativeSelection(),t.keyCode){case 8:t.preventDefault(),(this.maskCore.selection.start>this.marginLeft||this.maskCore.selection.start!==this.maskCore.selection.end)&&(this.maskCore.backspace(),this.updateToCoreState());break;case 37:t.preventDefault(),this.$refs.input.selectionStart===this.$refs.input.selectionEnd&&(this.$refs.input.selectionStart-=1),this.maskCore.selection={start:this.$refs.input.selectionStart,end:this.$refs.input.selectionStart},this.updateToCoreState();break;case 39:t.preventDefault(),this.$refs.input.selectionStart===this.$refs.input.selectionEnd&&(this.$refs.input.selectionEnd+=1),this.maskCore.selection={start:this.$refs.input.selectionEnd,end:this.$refs.input.selectionEnd},this.updateToCoreState();break;case 35:t.preventDefault(),this.$refs.input.selectionStart=this.$refs.input.value.length,this.$refs.input.selectionEnd=this.$refs.input.value.length,this.maskCore.selection={start:this.$refs.input.selectionEnd,end:this.$refs.input.selectionEnd},this.updateToCoreState();break;case 36:t.preventDefault(),this.$refs.input.selectionStart=0,this.$refs.input.selectionEnd=0,this.maskCore.selection={start:this.$refs.input.selectionStart,end:this.$refs.input.selectionStart},this.updateToCoreState();break;case 46:t.preventDefault(),this.$refs.input.selectionStart===this.$refs.input.selectionEnd?(this.maskCore.setValue(""),this.maskCore.setSelection({start:0,end:0}),this.$refs.input.selectionStart=this.maskCore.selection.start,this.$refs.input.selectionEnd=this.maskCore.selection.start):this.maskCore.backspace(),this.updateToCoreState()}else t.preventDefault()},keyPress:function(t){if(!t.ctrlKey){var e=!!document.documentMode,s="undefined"!=typeof InstallTrigger;(e||s)&&(t.preventDefault(),t.data=t.key,this.textInput(t))}},textInput:function(t){t.preventDefault&&t.preventDefault(),this.maskCore.input(t.data)&&(this.updateAfterAll=!0),this.updateToCoreState()},keyUp:function(t){9!==t.keyCode&&(this.updateToCoreState(),this.updateAfterAll=!1)},cut:function(t){if(t.preventDefault(),this.$refs.input.selectionStart!==this.$refs.input.selectionEnd){try{document.execCommand("copy")}catch(t){}this.maskCore.backspace(),this.updateToCoreState()}},copy:function(){},paste:function(t){var s=this;t.preventDefault();var e=t.clipboardData.getData("text");[].concat(e).reduce(function(t,e){return s.maskCore.input(e)},null),this.updateToCoreState()},updateToCoreState:function(){null!==this.maskCore&&(this.$refs.input.value!==this.maskCore.getValue()&&(this.$refs.input.value=this.maskCore.getValue(),this.$emit("input",this.$refs.input.value,this.maskCore.getRawValue())),this.$refs.input.selectionStart=this.maskCore.selection.start,this.$refs.input.selectionEnd=this.maskCore.selection.end)},isEmpty:function(){return null===this.maskCore||this.maskCore.getValue()===this.maskCore.emptyValue},focusOut:function(){this.isEmpty()&&(this.$refs.input.value="",this.maskCore.setSelection({start:0,end:0}),this.$emit("input","",""))},setNativeSelection:function(){this.maskCore.selection={start:this.$refs.input.selectionStart,end:this.$refs.input.selectionEnd}},mouseUp:function(){this.isEmpty()&&this.$refs.input.selectionStart===this.$refs.input.selectionEnd?(this.maskCore.setSelection({start:0,end:0}),this.$refs.input.selectionStart=this.maskCore.selection.start,this.$refs.input.selectionEnd=this.maskCore.selection.start,this.marginLeft=this.maskCore.selection.start,this.updateToCoreState()):this.setNativeSelection()}}}});